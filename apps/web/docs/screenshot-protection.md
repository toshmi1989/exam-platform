# Защита от скриншотов — варианты и ограничения

## Ограничения веб-платформы

**В браузере и в Telegram Mini App нельзя программно запретить или надёжно определить момент скриншота.** Захват экрана делается ОС/приложением, веб-страница не получает событий и не имеет API для блокировки.

## Что уже сделано в приложении

- **Выделение и копирование** отключены на страницах теста (`/attempt/*`): `user-select: none`, блокировка `copy`/`cut` и контекстного меню.
- **Скрытие контента при уходе с вкладки**: при переходе в другой таб/приложение контент теста скрывается overlay’ем; при возврате показывается после первого касания/клика. Так снижается польза от «переключился и сфоткал другой экран» — при возврате пользователь сначала видит заглушку.

## Варианты усиления защиты

### 1. Запрос функции у Telegram (рекомендуется)

Единственный способ **реально** запретить скриншот в Android — флаг **FLAG_SECURE** у окна. Его может выставить только нативное приложение (клиент Telegram), не веб-страница.

Имеет смысл:
- написать в [@BotSupport](https://t.me/BotSupport) или в [bugs.telegram.org](https://bugs.telegram.org) запрос на опцию вида: «при открытии Mini App с параметром `secure_content=1` устанавливать FLAG_SECURE для WebView»;
- описать сценарий: экзамены/тесты, необходимость защиты от копирования и скриншотов.

Если Telegram добавит такую опцию, в Mini App можно будет просто открывать ссылку с этим параметром — без смены стека.

### 2. Отдельное нативное приложение (TWA / Capacitor и т.п.)

- Собрать **нативную обёртку** (Android TWA, Capacitor, React Native и т.д.), которая открывает ваш веб-экран теста и для этого окна выставляет **FLAG_SECURE**.
- В таком приложении скриншот можно блокировать на уровне ОС.
- Минусы: отдельная сборка, публикация в сторах, поддержка; для текущего «только Telegram Mini App» это уже другой продукт.

### 3. Только веб (текущий стек)

- **Скриншот** — заблокировать нельзя, только усложнить копирование текста (уже сделано) и скрывать контент при уходе с вкладки (реализовано в layout теста).
- Дополнительно можно: не показывать все вопросы разом, лимитировать время, ротировать порядок вопросов/вариантов — это не блокирует скриншот, но снижает ценность одного снимка экрана.

## Итог

| Цель                    | В веб/Mini App сейчас        | Как добиться полной блокировки скриншота   |
|-------------------------|-----------------------------|-------------------------------------------|
| Нет копирования текста  | ✅ Реализовано              | —                                         |
| Нет скриншота           | ❌ Невозможно из веба       | Запрос FLAG_SECURE у Telegram или нативное приложение |

Файл с реализацией скрытия контента при уходе с вкладки: `apps/web/app/attempt/layout.tsx`.
